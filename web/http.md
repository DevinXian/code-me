### 为什么有了 ip 还需要 mac 地址

1. 根本：历史上数据链路层出现在网络层之前，存在数据链路层（二层）异构问题，引入网络层（三层）可统一上层封装，方便进行路由选择和分组转发等
2. ip 是逻辑地址，相当于通讯地址；mac 地址相当于身份证号；ip 引入分层结构，便于分层切换实现，也能提高查找效率，且支持子网划分
3. mac 地址太偏平，存储查询都是问题，不如网状分布式稳定，也不能实现子网划分，进行分组分区域管理和其他操作

### http2 主要特点

1. 二进制分帧，基于 TLS 层和应用层之间，将请求拆分成有流 ID 标记的二进制帧，而不是 http1.* 那种基于完整请求响应的方式，采用二进制内容，不用排队等待，便于多路复用
2. 多路复用：一个链接，所有请求和响应交织在一起，二进制分帧层进行组装交付 —— 基本解决 http 队头阻塞问题
3. 头部压缩：HPACK 算法进行传输，双方在动态表和静态表维护头部信息，重复的只传递头部编码，且采用了哈夫曼编码等优化方式
4. 优先级调整：可以设置优先级，避免低优先级限制了整体加载进度
5. 流量控制：基于流的流量控制，具体不详- -
6. 服务端推送等
7. 问题：基于 tpc 链接，握手慢 —— http3 QUIC 基于 UDP，有更好的链接时延表现

### Socket 是什么

1. Socket 是应用层与 TCP/IP 协议簇通信的中间抽象层，是一组接口（并不是协议）。Socket 作为门面将复杂的协议封装隐藏在接口内部，用户调用对应接口即可实现通信
2. 工作原理：初始化`socket()`, 绑定端口`bind()`并监听端口`listen()`，然后`accept()`表示准备完毕，阻塞等待客户端连接。客户端`connect()`连接之后，双方通过`write()`和`read()`进行消息收发，客户端收到消息后`close()`关闭连接； read 读取 read buffer 内容；write 读取 write buffer
3. 请求对象和响应对象都是序列化成字节交给 socket 进行发送，然后到接收端反序列化
4. 可分为长连接和短链接，长连接安全性差，消耗更多资源；http 等使用短连接

### http 跟 websocket 区别 [参考](https://www.geeksforgeeks.org/what-is-web-socket-and-how-it-is-different-from-the-http/)

1. 两者都是 client/server 模式下的通信协议，均基于 TCP 连接
2. http(s)
  
    - 单向的，client 发送请求， server 响应，一一对应
    - 响应发送完毕，连接关闭，所以是无状态协议（keep-alive 不改变根本）
    - 基于 TCP 三次握手建立连接以及丢包重传等机制
    - 消息都是使用 ASCII 编码（就是文本），包含 http 协议版本、http 方法、http 头部和 http 请求体等内容，通常是 700-800 字节范围

3. websocket

    - 全双工有状态协议，连接一旦建立需要主动关闭，且关闭之后双方都不能使用
    - 多应用在实时、游戏和聊天应用中；如果数据请求不频繁，建议使用 http，websocket 链接服务端压力大
    - 协议 ws:// 或者 wss://
    - 状态码 101 表示协议升级，响应头 Upgrade 告诉客户端服务端协议已升级

        ```
        HTTP/1.1 101 Switching Protocols
        Upgrade: websocket 
        Connection: Upgrade
        ```